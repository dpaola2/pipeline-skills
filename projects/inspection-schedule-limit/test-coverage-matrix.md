# Test Coverage Matrix — Increase Inspection Schedule Limit

> Generated by Pipeline Stage 4 (Test Generation)
> Maps every gameplan acceptance criterion to its test location(s).

| Milestone | Criterion ID | Description | Test File | Describe/Context |
|-----------|-------------|-------------|-----------|------------------|
| M1 | LIM-001 | Constant set to 1,000 | `spec/models/inspection_schedule_limit_spec.rb` | `describe "MAX_ACTIVE_SCHEDULES_PER_ACCOUNT" / it "is defined and set to 1000"` |
| M1 | LIM-002 | Single named constant, no magic numbers | `spec/requests/inspection_schedules_limit_spec.rb` | `context "when the account has reached the schedule limit"` (controller uses constant) |
| M1 | LIM-003 | `.active` scope counts non-deleted only | `spec/models/inspection_schedule_limit_spec.rb` | `context "when deleted schedules bring the active count below the limit"` |
| M1 | VAL-001 | Validation error message text | `spec/models/inspection_schedule_limit_spec.rb` | `context "when the account has reached the limit" / it "prevents creating a new schedule"` |
| M1 | VAL-002 | Error surfaced in web UI | `spec/requests/inspection_schedules_limit_spec.rb` | `it "displays the limit warning with the correct limit value"` |
| M1 | VAL-003 | Validation prevents saving (`on: :create`) | `spec/models/inspection_schedule_limit_spec.rb` | `it "prevents creating a new schedule"` |
| M1 | VAL-003 (edit) | Update allowed at limit | `spec/models/inspection_schedule_limit_spec.rb` | `context "when updating an existing schedule at the limit"` |
| M1 | Controller | `@at_limit` uses constant | `spec/requests/inspection_schedules_limit_spec.rb` | Both request spec tests (warning display + button hidden) |
| M1 | View | Warning banner shows correct limit | `spec/requests/inspection_schedules_limit_spec.rb` | `it "displays the limit warning with the correct limit value"` (asserts "1,000") |
| M1 | View | "New Schedule" button hidden at limit | `spec/requests/inspection_schedules_limit_spec.rb` | `it "hides the New Schedule button"` |

## Summary

- **Total acceptance criteria covered:** 10 (all M1 criteria)
- **Total test cases:** 7 (5 model + 2 request)
- **Files created:** 2
- **M2 (QA Test Data):** Not covered by automated tests — validated via manual QA

## Expected Failure Modes (Pre-Implementation)

| Test | Expected Failure |
|------|-----------------|
| Constant is 1000 | `NameError: uninitialized constant InspectionSchedule::MAX_ACTIVE_SCHEDULES_PER_ACCOUNT` |
| Prevents creating at limit | `expected #<InspectionSchedule ...> not to be valid` (no validation exists) |
| Request: warning display | Warning text not present (controller checks `>= 600`, not the constant) |
| Request: button hidden | "New Schedule" present (controller checks `>= 600`, not the constant) |
