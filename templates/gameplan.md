# [Feature Name] - Engineering Gameplan

> **Generated by:** Pipeline Stage 3 (Gameplan)
> **Date:** [Date]
> **PRD:** [Link]
> **Discovery Report:** [Link]
> **Approved Architecture:** [Link]
> **Linear Project:** [Link]

---

## 1. Project Overview

### Goals
- [What does success look like?]
- [What are we shipping?]

### Scope Summary

| Ticket | Description | Platform |
|--------|-------------|----------|
| [LIN-XXX] | [Brief description] | Web / iOS / Android |

### Out of Scope
- [Explicitly what we're NOT doing]

### Constraints & Conventions
- AGENTS.md: [Link to repo AGENTS.md]
- [Any project-specific constraints]

---

## 2. Open Questions & Decisions

> Resolved during Stages 1-2 (Discovery + Architecture)

| Question | Status | Decision |
|----------|--------|----------|
| [Question from discovery] | Resolved | [Decision] |
| [Question from architecture] | Resolved | [Decision] |
| [Remaining question] | Open | [Needs human input] |

---

## 3. Functional Milestones

> Organized by FEATURE AREA, not by platform.

### M0: Discovery & Alignment (Complete)
- [x] PRD parsed and understood (Stage 1)
- [x] Current state documented across platforms (Stage 1)
- [x] Data model proposed and **approved** (Stage 2 + Architecture Review)
- [x] API endpoints designed with example payloads and **approved** (Stage 2 + Architecture Review)
- [x] Open questions resolved (Stages 1-2)

### M1: [Feature Area 1 - e.g., Data Model & Core API]
**What:** [Brief description]
**Linear:** [LIN-XXX]

**Acceptance Criteria:**
- [ ] [XX-001]: [Specific, testable criterion]
- [ ] [XX-002]: [Specific, testable criterion]
- [ ] [XX-003]: [Specific, testable criterion]

**Web/API:**
- [ ] Migration: [create/alter table]
- [ ] Model: [Model with validations, associations, scopes]
- [ ] Controller: [Endpoints]
- [ ] Serializer: [Blueprint]
- [ ] Tests: [Model specs, request specs]

**iOS:**
- [ ] [Specific task or N/A]

**Android:**
- [ ] [Specific task or N/A]

**Dependencies:** None (first milestone)

---

### M2: [Feature Area 2 - e.g., Admin UI]
**What:** [Brief description]
**Linear:** [LIN-XXX]

**Acceptance Criteria:**
- [ ] [XX-010]: [Criterion]
- [ ] [XX-011]: [Criterion]

**Web/API:**
- [ ] [Specific tasks]

**iOS:**
- [ ] [Specific tasks]

**Android:**
- [ ] [Specific tasks]

**Dependencies:** M1 (needs data model)

---

### M3: [Feature Area 3 - e.g., Mobile UI]
**What:** [Brief description]
**Linear:** [LIN-XXX]

**Acceptance Criteria:**
- [ ] [XX-020]: [Criterion]

**Web/API:**
- [ ] [Specific tasks or N/A]

**iOS:**
- [ ] [Specific tasks]

**Android:**
- [ ] [Specific tasks]

**Dependencies:** M1 (needs API endpoints)

---

[Continue feature milestones as needed]

---

### M_PENULTIMATE_: QA Test Data
**What:** Create a seed task that populates realistic test data covering all feature scenarios. This enables manual QA without requiring testers to construct their own data. (Task format per `PIPELINE.md` Framework & Stack — e.g., rake task, management command, script.)

**Acceptance Criteria:**
- [ ] Seed task exists in the appropriate location (per `PIPELINE.md` Directory Structure, e.g., seed tasks directory)
- [ ] Task creates test account(s) with appropriate permissions and roles
- [ ] Task seeds data covering: happy path, empty states, edge cases, threshold boundaries
- [ ] Task is idempotent (can re-run without duplicating data)
- [ ] Task prints a summary of what was created (account credentials, key IDs, URLs to test)
- [ ] All scenarios from the manual QA checklist have supporting test data

**Primary Platform:**
- [ ] Seed task file — idempotent
- [ ] Uses existing test data helpers/factories where available
- [ ] No production-unsafe operations (dev/staging only)

**iOS:** N/A
**Android:** N/A

**Dependencies:** All prior feature milestones (needs the full feature implemented)

---

### M_LAST_: Empty States, Edge Cases & Polish
**What:** [Implement all empty state messages, handle edge cases, polish UI]

**Acceptance Criteria:**
- [ ] [UI empty state scenarios]
- [ ] [Edge case handling]
- [ ] [Print styles, responsive behavior]

**Web/API:**
- [ ] [View updates]

**Dependencies:** All prior milestones

---

## 4. Non-Functional Requirements Checklist

### Data Model & API
> These were reviewed and approved in the Architecture Review checkpoint. Reference the approved architecture for details.

- [ ] Architecture proposal approved: [Link]
- [ ] Milestones correctly reference the approved data model and API design
- [ ] No contradictions between gameplan and approved architecture

### Security & Access Control
- [ ] All queries scoped to account/user
- [ ] Controller authorization in place
- [ ] Feature permissions respected
- [ ] Area-based access respected (if applicable)
- [ ] API authentication required
- [ ] No new attack surfaces

### Performance
- [ ] Data volume x access frequency considered
- [ ] Query patterns identified
- [ ] Indexes sufficient
- [ ] Caching needed? [Yes/No]
- [ ] N+1 query risks identified

### Observability & Debuggability
- [ ] Logging plan (events, fields)
- [ ] Logs are human-readable
- [ ] Debug path exists without production access
- [ ] Alerts needed? [Yes/No]

### Analytics & Instrumentation

#### Success Metrics
> How will we know this feature is working? Reference PRD goals or define measurable outcomes.

- [ ] [e.g., "50% of accounts with eligible data use the report within 30 days"]
- [ ] [e.g., "Export usage averages >10 exports/week across all accounts"]
- Or: N/A — no measurable success criteria for this feature

#### Events to Track

| Event Name | Trigger | Key Properties | Platform |
|------------|---------|----------------|----------|
| [e.g., `deficient_report.viewed`] | [User opens the report page] | [account_id, user_id, filter_count] | [Web] |
| [e.g., `deficient_report.exported`] | [User clicks CSV or PDF export] | [format, row_count, filtered] | [Web] |

_If the product has no event tracking infrastructure, note that here and skip the table._

#### Instrumentation Approach
- [ ] Framework: [e.g., "Ahoy events", "server-side logging", "Mixpanel", "custom analytics table", "none — no tracking infrastructure yet"]
- [ ] Implementation location: [e.g., "Controller after_action callbacks", "Stimulus event handlers", "service layer"]

### Testing Plan

| Type | Coverage | Platform | Owner |
|------|----------|----------|-------|
| Model/unit specs | [What's covered] | Rails | Pipeline |
| Request/API specs | [What's covered] | Rails | Pipeline |
| System/E2E specs | [What's covered] | Rails | Pipeline |
| Unit tests | [What's covered] | iOS | Pipeline |
| Unit tests | [What's covered] | Android | Pipeline |
| Manual QA | [Key scenarios] | All | Human |

### Feature Flags & Rollout
- [ ] Feature flag: `[flag_name]`
- [ ] Default: Off
- [ ] Beta flag for select accounts
- [ ] Rollout plan: [phases]

### Mobile-Specific
- [ ] Firebase events planned
- [ ] Crash reporting considerations
- [ ] Offline behavior defined (if applicable)
- [ ] Min OS version implications

### Legacy & Migration
- [ ] Old client experience documented (compatibility matrix)
- [ ] Backward compatibility requirements met
- [ ] Data migration from old → new (if applicable)

### Export/Reporting
- [ ] Export requirements addressed
- [ ] Export backwards compatibility maintained
- [ ] N/A

---

## 5. Dependencies & Risks

| Risk/Dependency | Impact | Mitigation |
|-----------------|--------|------------|
| [Risk 1] | High / Med / Low | [Mitigation strategy] |
| [Dependency 1] | [Impact] | [How we handle it] |

---

## 6. Release Plan

### Phases

| Phase | What Ships | Flag State | Audience |
|-------|-----------|------------|----------|
| Phase 1 | [Milestones M1-M2] | Beta ON for test accounts | Internal |
| Phase 2 | [All milestones] | Beta ON for select customers | Beta customers |
| Phase 3 | [GA] | Feature ON for all | All customers |

### Done Criteria
- [ ] All acceptance criteria met
- [ ] All tests passing
- [ ] Feature flag enabled for beta accounts
- [ ] Observability in place
- [ ] QA sign-off

---

## 7. Estimates

| Milestone | Size | Notes |
|-----------|------|-------|
| M0: Discovery | Done | Pipeline Stages 0-2 |
| M1: [Name] | S / M / L / XL | |
| M2: [Name] | S / M / L / XL | |
| M3: [Name] | S / M / L / XL | |

**Size guide:** S = 1-3 files, no migrations, no new patterns. M = 5-10 files, simple migration, follows existing conventions. L = 10-20 files, complex migrations, new patterns. XL = 20+ files, should probably be split.

---

## Approval Checklist

> **This gameplan requires human review and approval before test generation begins.**

### Reviewer: ___________
### Date: ___________
### Status: Pending

#### Must Verify
- [ ] Milestone breakdown is logical and correctly sequenced
- [ ] Acceptance criteria are specific and testable
- [ ] Every PRD requirement ID is mapped to a milestone (traceability matrix complete)
- [ ] Non-functional requirements checklist is fully addressed
- [ ] Dependencies form a valid DAG (no circular dependencies)
- [ ] Milestone sizes are appropriate (no XL milestones that should be split)
- [ ] Release plan is appropriate

#### Optional Notes
[Any modifications, corrections, or additional context for the implementation team]

---

## Changelog

| Date | Author | Changes |
|------|--------|---------|
| [Date] | Pipeline | Initial gameplan generated |
| [Date] | [Human reviewer] | Approved with modifications: [notes] |
